---
- hosts: localhost
  tasks:
    - name: Add git-duet tap for Homebrew
      homebrew_tap:
        name: git-duet/tap
        state: present
    - name: Install common packages
      homebrew:
        name:
          - asdf
          - git
          - git-duet
          - gnupg
          - pinentry-mac
          - wget
          - zsh-git-prompt
        state: present
    - name: Check status of full-disk encryption
      command: fdesetup status
      register: filevault_status
    - name: Enable full-disk encryption
      command: fdesetup enable
      when: filevault_status.stdout.find('FileVault in On.') != -1
      become: true
